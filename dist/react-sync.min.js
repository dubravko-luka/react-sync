!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("react"),require("jquery")):"function"==typeof define&&define.amd?define(["react","jquery"],r):"object"==typeof exports?exports.ReactSync=r(require("react"),require("jquery")):t.ReactSync=r(t.React,t.$)}(this,function(t,r){return function(t){function r(n){if(e[n])return e[n].exports;var o=e[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var e={};return r.m=t,r.c=e,r.p="",r(0)}([function(t,r,e){"use strict";var n=e(1),o=e(2),s=e(3),a=e(7),i=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},p="data",u="loading",c="fetched",l="onSave",h="onDelete",f=n.PropTypes,d={rootUrl:f.string.isRequired,id:f.oneOfType([f.string,f.number]),dataName:f.string,fetchOnMount:f.bool,fetchOnNewProps:f.bool,params:f.object,traditionalParams:f.bool,count:f.number,countParam:f.string,start:f.number,startParam:f.string,sorts:f.arrayOf(f.shape({attribute:f.string.isRequired,desc:f.bool.isRequired})),sortInfoSeparator:f.string,sortParam:f.string,onCreate:f.func,onRead:f.func,onUpdate:f.func,onDelete:f.func,onError:f.func,ajaxOptions:f.object},g=Object.keys(d).concat("children");t.exports=n.createClass({displayName:"React Sync",propTypes:d,getDefaultProps:function(){return{id:null,dataName:"",fetchOnMount:!0,fetchOnNewProps:!0,params:null,traditionalParams:!0,sorts:null,sortInfoSeparator:"|",sortParam:"sort",start:null,startParam:"start",count:null,countParam:"count",onCreate:null,onRead:null,onUpdate:null,onDelete:null,onError:null,ajaxOptions:null}},getInitialState:function(){return{data:null,fetched:!1,loading:!1,lastFetchUrl:null}},getParameterObject:function(){var t=o.extend({},this.props.params);if(null!==this.props.start&&null!==this.props.count&&(t[this.props.startParam]=this.props.start,t[this.props.countParam]=this.props.count),null!==this.props.sorts&&this.props.sorts.length>0){var r=this.props.sortInfoSeparator;t[this.props.sortParam]=o.map(this.props.sorts,function(t){return(t.desc?"D":"A")+r+t.attribute})}return t},getUrl:function(t){var r=this.props.rootUrl;return null!==this.props.id&&("/"===r[r.length-1]?r+=this.props.id:r=r+"/"+this.props.id),t&&(r=r+"?"+o.param(this.getParameterObject(),this.props.traditionalParams)),r},setLoading:function(t,r){this.isMounted()&&this.setState({loading:t},r)},fetch:function(){var t=this.getUrl(!0);this.setState({loading:!0,lastFetchUrl:t},function(){o.ajax(o.extend({},this.props.ajaxOptions,{url:t,context:this,success:function(t,r,e){this.setLoading(!1),this.markFetched(),this.setData(t),null!==this.props.onRead&&this.props.onRead.apply(this,arguments)},error:function(t,r,e){this.setLoading(!1),this.clearData(),null!==this.props.onError&&this.props.onError.apply(this,arguments)}}))})},clearData:function(){this.setData(null)},setData:function(t){this.isMounted()&&this.setState({data:t})},markFetched:function(){this.isMounted()&&(this.state.fetched||this.setState({fetched:!0}))},componentDidMount:function(){this.props.fetchOnMount&&this.fetch()},componentDidUpdate:function(t,r){this.props.fetchOnNewProps&&this.getUrl(!0)!==this.state.lastFetchUrl&&this.fetch()},doSave:function(t){var r=null===this.props.id;this.setLoading(!0,function(){o.ajax(o.extend({},this.props.ajaxOptions,{method:r?"POST":"PUT",data:t,url:this.getUrl(!1),context:this,success:function(t,e,n){this.setLoading(!1),this.clearData();var o=r?this.props.onCreate:this.props.onUpdate;null!==o&&o.apply(this,arguments)},error:function(t,r,e){this.setLoading(!1),null!==this.props.onError&&this.props.onError.apply(this,arguments)}}))})},doDelete:function(){this.setLoading(!0,function(){o.ajax(o.extend({},this.props.ajaxOptions,{method:"DELETE",url:this.getUrl(!1),context:this,success:function(t,r,e){this.setLoading(!1),this.clearData(),null!==this.props.onDelete&&this.props.onDelete.apply(this,arguments)},error:function(t,r,e){this.setLoading(!1),null!==this.props.onError&&this.props.onError.apply(this,arguments)}}))})},getChildProps:function(){var t=s(this.props,g),r=this.props.dataName,e=r.length>0;return t[r+(e?i(p):p)]=this.state.data,t[r+(e?i(u):u)]=this.state.loading,t[r+(e?i(c):c)]=this.state.fetched,t[l+(e?i(r):r)]=a.call(this.doSave,this),t[h+(e?i(r):r)]=a.call(this.doSave,this),t},render:function(){return n.cloneElement(n.Children.only(this.props.children),this.getChildProps())}})},function(r,e){r.exports=t},function(t,e){t.exports=r},function(t,r,e){/*!
	 * object.omit <https://github.com/jonschlinkert/object.omit>
	 *
	 * Copyright (c) 2014-2015, Jon Schlinkert.
	 * Licensed under the MIT License.
	 */
"use strict";var n=e(4),o=e(5);t.exports=function(t,r){if(!n(t))return{};var e,r=[].concat.apply([],[].slice.call(arguments,1)),s=r[r.length-1],a={};"function"==typeof s&&(e=r.pop());var i="function"==typeof e;return r.length||i?(o(t,function(n,o){-1===r.indexOf(o)&&(i?e(n,o,t)&&(a[o]=n):a[o]=n)}),a):t}},function(t,r){/*!
	 * is-extendable <https://github.com/jonschlinkert/is-extendable>
	 *
	 * Copyright (c) 2015, Jon Schlinkert.
	 * Licensed under the MIT License.
	 */
"use strict";t.exports=function(t){return"undefined"!=typeof t&&null!==t&&("object"==typeof t||"function"==typeof t)}},function(t,r,e){/*!
	 * for-own <https://github.com/jonschlinkert/for-own>
	 *
	 * Copyright (c) 2014-2015, Jon Schlinkert.
	 * Licensed under the MIT License.
	 */
"use strict";var n=e(6),o=Object.prototype.hasOwnProperty;t.exports=function(t,r,e){n(t,function(n,s){return o.call(t,s)?r.call(e,t[s],s,t):void 0})}},function(t,r){/*!
	 * for-in <https://github.com/jonschlinkert/for-in>
	 *
	 * Copyright (c) 2014-2015, Jon Schlinkert.
	 * Licensed under the MIT License.
	 */
"use strict";t.exports=function(t,r,e){for(var n in t)if(r.call(e,t[n],n,t)===!1)break}},function(t,r){var e="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,o=Object.prototype.toString,s="[object Function]";t.exports=function(t){var r=this;if("function"!=typeof r||o.call(r)!==s)throw new TypeError(e+r);for(var a=n.call(arguments,1),i=function(){if(this instanceof l){var e=r.apply(this,a.concat(n.call(arguments)));return Object(e)===e?e:this}return r.apply(t,a.concat(n.call(arguments)))},p=Math.max(0,r.length-a.length),u=[],c=0;p>c;c++)u.push("$"+c);var l=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(i);if(r.prototype){var h=function(){};h.prototype=r.prototype,l.prototype=new h,h.prototype=null}return l}}])});